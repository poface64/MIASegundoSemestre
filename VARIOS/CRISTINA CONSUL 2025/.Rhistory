# MARIHUANA
# TABACO
names(datos1)
mini = datos1[,c(19,1,4,8,10,12,14,16)]
names(mini)
names(mini) = c("Edad","Sexo","Región","CAR","TIC","ALCOHOL","MARIHUANA","TABACO")
head(mini)
#### sexo, edad, CAR, TICS consumos
# Para hacer el correspondencias MULTIPLES
library(FactoClass)
library(FactoMineR)
install.packages("factoextra")
library(factoextra)
head(mini)
#### sexo, edad, CAR, TICS consumos ###
# Para hacer el correspondencias MULTIPLES
names(mini)
#### sexo, edad, CAR, TICS consumos ###
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(2,1,4,5,6,7,8)]
P1
ACM = MCA(P1,graph = T)
#### sexo, edad, CAR, TICS consumos ###
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(2,1,4,5,6,7,8)]
library(factoextra)
#### sexo, edad, CAR, TICS consumos ###
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(2,1,4,5,6,7,8)]
ACM = MCA(P1,graph = T)
install.packages("FactoMineR")
library(FactoMineR)
library(FactoMineR)
library(factoextra)
#### sexo, edad, CAR, TICS consumos ###
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(2,1,4,5,6,7,8)]
ACM = MCA(P1,graph = T)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM, addlabels = TRUE)
#### sexo, edad, CAR, TICS consumos ###
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(2,1,4,5,6,7,8)]
ACM1 = MCA(P1,graph = T)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM, addlabels = TRUE)
# Gráfico biplot
library(ggthemes)
fviz_mca_biplot(ACM1,
repel = T) +
theme_stata()
# Gráfico biplot
fviz_mca_biplot(ACM1,
repel = T)
# Gráfico biplot
fviz_mca_biplot(ACM1)
table(datos$CFL.ÁREA.TRAB)
names(mini)
#### sexo, edad, CAR, TICS consumos ####
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(2,1,3,4,5,6,7,8)]
ACM1 = MCA(P1,graph = T)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM, addlabels = TRUE)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM1, addlabels = TRUE)
# Gráfico biplot
fviz_mca_biplot(ACM1)
table(mini$Región)
table(mini$Región) |> sum()
dim(mini)
is.na(mini$Región) |> sum()
mini[is.na(mini$Región)==T,]
table(mini$Región)
mini[is.na(mini$Región)==T,3]
####  Separar las variables de interes ####
mini = datos1[,c(19,1,4,8,10,12,14,16)]
names(mini) = c("Edad","Sexo","Región","CAR","TIC","ALCOHOL","MARIHUANA","TABACO")
#### Poza rica imputación del dato ####
mini[is.na(mini$Región)==T,3] = "Poza Rica-Tuxpan"
head(mini)
#### sexo, edad, CAR, TICS consumos ####
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(2,1,3,4,5,6,7,8)]
ACM1 = MCA(P1,graph = T)
table(mini$Región)
table(mini$Región) |> sum()
#### sexo, edad, CAR, TICS consumos ####
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(2,1,3,4,5,6,7,8)]
ACM1 = MCA(P1,graph = T)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM1, addlabels = TRUE)
# Gráfico biplot
fviz_mca_biplot(ACM1)
names(mini)
P1 = mini[,c(1,3,4,5,6,7,8)]
ACM1 = MCA(P1,graph = T)
#### sexo, edad, CAR, TICS consumos ####
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(2,3,4,5,6,7,8)]
ACM1 = MCA(P1,graph = T)
names(mini)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM1, addlabels = TRUE)
# Gráfico biplot
fviz_mca_biplot(ACM1)
#### sexo, edad, CAR, TICS consumos ####
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(3,4,5,6,7,8)]
ACM1 = MCA(P1,graph = T)
names(P1)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM1, addlabels = TRUE)
# Gráfico biplot
fviz_mca_biplot(ACM1)
mini[c(115,208),]
####
ggsave("g1.svg", g1,
width = 12, height = 6,
dpi = 8000)
# Gráfico biplot
g1 = fviz_mca_biplot(ACM1)
####
ggsave("g1.svg", g1,
width = 12, height = 6,
dpi = 8000)
sv = rsvg("g1.svg",
height = 2000,
width = 6000)
####
library(rsvg)
####
library(rsvg)
library(jpeg)
ggsave("g1.svg", g1,
width = 12, height = 6,
dpi = 8000)
sv = rsvg("g1.svg",
height = 2000,
width = 6000)
### Exportar en jpeg
writeJPEG(sv, "g1.jpg",
quality = 12)
####
library(rsvg)
library(jpeg)
ggsave("g1.svg", g1,
width = 8, height = 6,
dpi = 8000)
sv = rsvg("g1.svg",
height = 2000,
width = 4000)
### Exportar en jpeg
writeJPEG(sv, "g1.jpg",
quality = 12)
####
library(rsvg)
library(jpeg)
ggsave("g1.svg", g1,
width = 8, height = 6,
dpi = 8000)
sv = rsvg("g1.svg",
height = 2000,
width = 3000)
### Exportar en jpeg
writeJPEG(sv, "g1.jpg",
quality = 12)
#######################
#### Buscar la asociación entre las variables por edad
# Hago el contenedor de variables
table(mini$Edad)
names(mini)
varis = c("CAR",
"TIC",
"ALCOHOL",
"MARIHUANA",
"TABACO")
### Creo el contenedor
contenedor =  data.frame(var1="H",var2="H" ,Ji = 0,G.l = 0,Pvalor = 0)
names(mini)
vrb = "Edad"
varis = c("CAR",
"TIC",
"ALCOHOL",
"MARIHUANA",
"TABACO")
### Creo el contenedor
contenedor =  data.frame(var1="H",var2="H" ,Ji = 0,G.l = 0,Pvalor = 0)
### Extraer los nombres
sujeto[,1:2] = c(varis[i],"Edad")
i = 1
#### Fijando la variable de sexo
#### Hacer el recorrido ####
sujeto = contenedor[1,]
sujeto
### Extraer los nombres
sujeto[,1:2] = c(varis[i],"Edad")
sujeto
### Hago la tabla chi
# Variables
vrb = c(varis[i],"Edad")
vrb
tabla = table(mini[,vrb])
tabla
tabla = table(mini[,vrb])
tabla
chicuad = chisq.test(tabla)
chicuad
### Agregar al sujeto lo que falta
sujeto[,3:5] = round(c(chicuad$statistic,
chicuad$parameter,
chicuad$p.value),6)
### Poner el sujeto en su lugar
contenedor  = rbind.data.frame(contenedor,
sujeto)
contenedor
varis = c("CAR",
"TIC",
"ALCOHOL",
"MARIHUANA",
"TABACO")
### Creo el contenedor
contenedor =  data.frame(var1="H",var2="H" ,Ji = 0,G.l = 0,Pvalor = 0)
### Ciclo para la cosa ###
for(i in 1:length(varis)){
#### Fijando la variable de sexo
#### Hacer el recorrido ####
sujeto = contenedor[1,]
### Extraer los nombres
sujeto[,1:2] = c(varis[i],"Edad")
### Hago la tabla chi
# Variables
vrb = c(varis[i],"Edad")
tabla = table(mini[,vrb])
chicuad = chisq.test(tabla)
### Agregar al sujeto lo que falta
sujeto[,3:5] = round(c(chicuad$statistic,
chicuad$parameter,
chicuad$p.value),6)
### Poner el sujeto en su lugar
contenedor  = rbind.data.frame(contenedor,
sujeto)
}
contenedor
contenedor$Pvalor1 = round(contenedor$Pvalor,2)
contenedor
table(mini$Edad,mini$TIC)
table(mini$Edad,mini$TIC)
table(mini$Edad,mini$ALCOHOL)
table(mini$Edad,mini$MARIHUANA)
table(mini$Edad,mini$TABACO)
rm(list = ls())
#### CARGAR LA BASE DE DATOS ####
library(readxl)
ruta = "BASE DE DATOS CARDIS-1.xlsx"
datos = read_excel(ruta,
sheet = "Hoja1") |> as.data.frame()
#### Separar las variables de interés
vars = c(3:8,63:72,6)
datos1 = datos[,vars]
head(datos1)
table(datos1$`¿A qué región de la Universidad Veracruzana perteneces?.1`)
#### Nuevo esquema ####
#### Sección CAR ####
datos1$CAR...64 = factor(datos1$CAR...64,
levels = c("Sin riesgo",
"Riesgo moderado",
"Riesgo alto"))
#### Sección TICS ####
datos1$TIC...66 = factor(datos1$TIC...66,
levels = c("Inexistencia de problema",
"Uso problemático",
"Abuso",
"Dependencia"))
#### SECCIÓN ALCOHOL ####
datos1$ALCOHOL...68 = factor(datos1$ALCOHOL...68,
levels = c("Riesgo bajo",
"Riesgo medio",
"Riesgo alto",
"Adicción"))
#### MARIGUANA ####
datos1$MARIHUANA2 = factor(datos1$MARIHUANA2,
levels = c("Riesgo bajo",
"Riesgo medio",
"Riesgo alto" ))
#### TABACO
datos1$TABACO2 = factor(datos1$TABACO2,
levels = c("Dependencia baja",
"Dependencia moderada"))
#### Edad ####
datos1$edad1 = datos$`¿Cuántos años cumplidos tienes?`
### Esquema de discretización ###
datos1$edad2[datos1$edad1<=18] = "18 o ménos"
datos1$edad2[datos1$edad1>=19 & datos1$edad1<=20] = "19 a 20"
datos1$edad2[datos1$edad1>=21 & datos1$edad1<=22] = "21 a 22"
datos1$edad2[datos1$edad1>=23 & datos1$edad1<=24] = "23 a 24"
datos1$edad2[datos1$edad1>24] = "24 o más"
####  Separar las variables de interes ####
mini = datos1[,c(19,1,4,8,10,12,14,16)]
names(mini) = c("Edad","Sexo","Región","CAR","TIC","ALCOHOL","MARIHUANA","TABACO")
#### Poza rica imputación del dato ####
mini[is.na(mini$Región)==T,3] = "Poza Rica-Tuxpan"
library(FactoMineR)
library(factoextra)
#### sexo, edad, CAR, TICS consumos ###
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(2,1,4,5,6,7,8)]
head(P1)
rm(list = ls())
#### CARGAR LA BASE DE DATOS ####
library(readxl)
ruta = "BASE DE DATOS CARDIS-1.xlsx"
datos = read_excel(ruta,
sheet = "Hoja1") |> as.data.frame()
#### Separar las variables de interés
vars = c(3:8,63:72,6)
datos1 = datos[,vars]
head(datos1)
table(datos1$`¿A qué región de la Universidad Veracruzana perteneces?.1`)
#### Nuevo esquema ####
#### Sección CAR ####
datos1$CAR...64 = factor(datos1$CAR...64,
levels = c("Sin riesgo",
"Riesgo moderado",
"Riesgo alto"))
#### Sección TICS ####
datos1$TIC...66 = factor(datos1$TIC...66,
levels = c("Inexistencia de problema",
"Uso problemático",
"Abuso",
"Dependencia"))
#### SECCIÓN ALCOHOL ####
datos1$ALCOHOL...68 = factor(datos1$ALCOHOL...68,
levels = c("Riesgo bajo",
"Riesgo medio",
"Riesgo alto",
"Adicción"))
#### MARIGUANA ####
datos1$MARIHUANA2 = factor(datos1$MARIHUANA2,
levels = c("Riesgo bajo",
"Riesgo medio",
"Riesgo alto" ))
#### TABACO
datos1$TABACO2 = factor(datos1$TABACO2,
levels = c("Dependencia baja",
"Dependencia moderada"))
#### Edad ####
datos1$edad1 = datos$`¿Cuántos años cumplidos tienes?`
### Esquema de discretización ###
datos1$edad2[datos1$edad1<=18] = "18 o ménos"
datos1$edad2[datos1$edad1>=19 & datos1$edad1<=20] = "19 a 20"
datos1$edad2[datos1$edad1>=21 & datos1$edad1<=22] = "21 a 22"
datos1$edad2[datos1$edad1>=23 & datos1$edad1<=24] = "23 a 24"
datos1$edad2[datos1$edad1>24] = "24 o más"
####  Separar las variables de interes ####
mini = datos1[,c(19,1,4,8,10,12,14,16)]
names(mini) = c("Edad","Sexo","Región","CAR","TIC","ALCOHOL","MARIHUANA","TABACO")
#### Poza rica imputación del dato ####
mini[is.na(mini$Región)==T,3] = "Poza Rica-Tuxpan"
head(mini)
head(datos1)
#### Revisar los puntajes ####
mini2 = datos1[ ,c(3,7,9,11,13,15,17)]
head(mini2)
#### Revisar los puntajes ####
mini2 = datos1[ ,c(3,7,9,11,13,15,18)]
head(mini2)
#### Revisar los puntajes ####
mini2 = datos1[ ,c(7,9,11,13,15,18)]
head(mini2)
#### Revisar los puntajes ####
mini2 = datos1[ ,c(7,9,11,13,15,18)]
names(mini2) = c("CAR","TIC","ALCOHOL","ALCOHOL","MARIHUANA","TABACO","EDAD")
names(mini2) = c("CAR","TIC","ALCOHOL","MARIHUANA","TABACO","EDAD")
head(mini2)
### VERIFICAR LA NORMALIDAD DE LAS VARIABLES ####
shapiro.test(mini2$CAR)
shapiro.test(mini2$TIC) # No es normal
shapiro.test(mini2$ALCOHOL) # No es normal
shapiro.test(mini2$MARIHUANA) # No es normal
shapiro.test(mini2$TABACO) # No es normal
shapiro.test(mini2$EDAD) # No es normal
plot(mini2)
plot(mini2[,-6],
pch = 16)
#### Correlación de SPEARMAN ####
library(corrplot)
cor(mini2[,-6])
corrplot(cor(mini2[,-6]))
corrplot(corrplot(cor(mini2[,-6])),
addCoef.col = 'black', tl.pos = 'd',
cl.pos = 'n')
corrplot(cor(mini2[,-6]),
addCoef.col = 'black', tl.pos = 'd',
cl.pos = 'n')
rm(list=ls())
# Pasar los datos a limpio #
library(readxl)
ruta = "BASE DE DATOS CARDIS-1.xlsx"
datos = read_excel(ruta,
sheet = "Hoja1") |> as.data.frame()
#### Separar las variables de interés
vars = c(3:8,63:72,6)
datos1 = datos[,vars]
head(datos1)
table(datos1$`¿A qué región de la Universidad Veracruzana perteneces?.1`)
#### Nuevo esquema ####
#### Sección CAR ####
datos1$CAR...64 = factor(datos1$CAR...64,
levels = c("Sin riesgo",
"Riesgo moderado",
"Riesgo alto"))
#### Sección TICS ####
datos1$TIC...66 = factor(datos1$TIC...66,
levels = c("Inexistencia de problema",
"Uso problemático",
"Abuso",
"Dependencia"))
#### SECCIÓN ALCOHOL ####
datos1$ALCOHOL...68 = factor(datos1$ALCOHOL...68,
levels = c("Riesgo bajo",
"Riesgo medio",
"Riesgo alto",
"Adicción"))
#### MARIGUANA ####
datos1$MARIHUANA2 = factor(datos1$MARIHUANA2,
levels = c("Riesgo bajo",
"Riesgo medio",
"Riesgo alto" ))
#### TABACO
datos1$TABACO2 = factor(datos1$TABACO2,
levels = c("Dependencia baja",
"Dependencia moderada"))
#### Edad ####
datos1$edad1 = datos$`¿Cuántos años cumplidos tienes?`
### Esquema de discretización ###
datos1$edad2[datos1$edad1<=18] = "18 o ménos"
datos1$edad2[datos1$edad1>=19 & datos1$edad1<=20] = "19 a 20"
datos1$edad2[datos1$edad1>=21 & datos1$edad1<=22] = "21 a 22"
datos1$edad2[datos1$edad1>=23 & datos1$edad1<=24] = "23 a 24"
datos1$edad2[datos1$edad1>24] = "24 o más"
####  Separar las variables de interes ####
mini = datos1[,c(19,1,4,8,10,12,14,16)]
names(mini) = c("Edad","Sexo","Región","CAR","TIC","ALCOHOL","MARIHUANA","TABACO")
#### Poza rica imputación del dato ####
mini[is.na(mini$Región)==T,3] = "Poza Rica-Tuxpan"
head(datos1)
#### Revisar los puntajes ####
mini2 = datos1[ ,c(7,9,11,13,15,18)]
names(mini2) = c("CAR","TIC","ALCOHOL","MARIHUANA","TABACO","EDAD")
names(datos1)
head(mini1)
head(mini)
head(mini2)
hist(mini2$ALCOHOL)
#### sexo, edad, CAR, TICS consumos ###
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(2,1,4,5,6,7,8)]
head(P1)
ACM1 = MCA(P1,graph = T)
library(FactoMineR)
library(factoextra)
#### sexo, edad, CAR, TICS consumos ###
# Para hacer el correspondencias MULTIPLES
P1 = mini[,c(2,1,4,5,6,7,8)]
head(P1)
ACM1 = MCA(P1,graph = T)
table(datos$CFL.ÁREA.TRAB)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM, addlabels = TRUE)
ACM = MCA(P1,graph = T)
table(datos$CFL.ÁREA.TRAB)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM, addlabels = TRUE)
# Gráfico biplot
fviz_mca_biplot(ACM1)
P1[c(115,203),]
table(P1$MARIHUANA)
table(P1$ALCOHOL)
ACM = MCA(P1[,c(115,203,)],graph = T)
ACM = MCA(P1[c(115,203),],graph = T)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM, addlabels = TRUE)
# Gráfico biplot
fviz_mca_biplot(ACM1)
ACM1 = MCA(P1[c(115,203),],graph = T)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM, addlabels = TRUE)
# Gráfico biplot
fviz_mca_biplot(ACM1)
ACM1 = MCA(P1[-c(115,203),],graph = T)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM, addlabels = TRUE)
# Gráfico biplot
fviz_mca_biplot(ACM1)
ACM1 = MCA(P1[-c(115,116,203),],graph = T)
# Gráfico de sedimentos con etiquetas
fviz_screeplot(ACM, addlabels = TRUE)
# Gráfico biplot
fviz_mca_biplot(ACM1)
# Gráfico biplot
fviz_mca_biplot(ACM)
########## Revisar los minis  y los datos modificados ####
library(xlsx)
write.csv(min1,"cristilimpiosCAT.csv",row.names = F)
########## Revisar los minis  y los datos modificados ####
write.csv(mini1,"cristilimpiosCAT.csv",row.names = F)
write.csv(mini2,"cristilimpiosNUM.csv",row.names = F)
########## Revisar los minis  y los datos modificados ####
write.csv(mini,"cristilimpiosCAT.csv",row.names = F)
write.csv(mini2,"cristilimpiosNUM.csv",row.names = F)
